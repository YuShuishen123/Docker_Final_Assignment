# 后端接口和前端需求文档

## 基础信息
- **服务器地址**: `http://localhost:8080`
- **接口基础路径**: 
  - 角色相关：`http://localhost:8080/roles`
  - 用户相关：`http://localhost:8080/users`
- **Content-Type**: `application/json`
- **字符编码**: `UTF-8`



## 预计前端内容（重点）：

- 登陆页面，有注册按钮，点击注册按钮跳转到主页侧面，提供所需信息进行注册
  - 用户名要求：6位字符以上，只能由英文和数字组成，区分大小写
  - 密码：6位字符以上，只能由英文和数字组成，区分大小写，必须同时有英文和数字
  - 角色名称：不做要求，可以为中文，长度不能超过10个字
- 主页：左侧有侧边栏，有全部成员（登陆成功默认显示全部成员），修改角色信息，修改用户信息等选项
  - 头部导航，有系统名称，角色个人信息，用户名等
  - 侧边栏
    - 修改个人信息：显示全部个人信息内容修改框，不修改的就为原来的内容，下方有提交按钮
    - 修改角色信息：修改角色名称，密码
    - 用户管理：创建用户，删除用户等，根据后端接口来开发
  - 右上角有设置按钮，点击展开二级目录，有退出登陆和注销角色的选项
  - 显示全部成员界面上方有搜索栏，可以根据关键字进行搜索
- 修改密码，以及注册成功后，跳转到登陆页面
- 未登录请求内部资源将会提示未登录并且跳转到登陆界面
- 风格统一，富有美感，动感，科技感，交互体验良好，有加载画面，良好的输入提示等，采用VUE3语法结构开发，代码带有注释
- 在开发代码的同时补充一份说明文档，随着项目的进度，逐步的补充说明文档



## 全局请求头配置

## 目录
- [数据库设计](#数据库设计)
- [角色认证相关接口](#角色认证相关接口)
- [用户管理相关接口](#用户管理相关接口)

## 数据库设计

### roles表（角色表）
| 字段名 | 类型 | 约束 | 说明 |
|-------|------|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 角色ID |
| username | VARCHAR(100) | NOT NULL, UNIQUE | 用户登录名 |
| password_hash | VARCHAR(255) | NOT NULL | 加密后的密码 |
| role_name | VARCHAR(50) | NOT NULL | 角色名称 |

### users表（用户表）
| 字段名 | 类型 | 约束 | 说明 |
|-------|------|------|------|
| id | INT | PRIMARY KEY, AUTO_INCREMENT | 用户ID |
| student_id | VARCHAR(20) | NOT NULL, UNIQUE | 学号 |
| name | VARCHAR(100) | NOT NULL | 姓名 |
| work | VARCHAR(255) | NOT NULL | 负责工作 |
| class_ | VARCHAR(100) | NOT NULL | 班级 |
| role_id | INT | NOT NULL, UNIQUE, FOREIGN KEY | 关联的角色ID |

注意：
1. role_id 是外键，关联到 roles 表的 id 字段
2. 当删除角色时，会级联删除对应的用户记录
3. role_id 设置为 UNIQUE，确保一个角色只能创建一个用户

## 角色认证相关接口

### 1. 注册
- **接口URL**: `/roles/register`
- **请求方式**: POST
- **参数传递方式**: Query Parameters
- **请求参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |-------|------|------|------|
  | username | String | 是 | 用户名 |
  | password | String | 是 | 密码 |
  | roleName | String | 是 | 角色名称 |

- **响应结果**:  ```json
  {
    "code": 200/400/500,  // 状态码
    "msg": "注册成功/用户名已被占用/用户名或密码不能为空/数据库错误/服务器错误",  // 响应信息
    "data": null,  // 数据
    "token": null  // 令牌
  }  ```

### 2. 登录
- **接口URL**: `/roles/login`
- **请求方式**: POST
- **参数传递方式**: Query Parameters
- **请求参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |-------|------|------|------|
  | username | String | 是 | 用户名 |
  | password | String | 是 | 密码 |

- **响应结果**:  ```json
  {
    "code": 200/400/500,  // 状态码
    "msg": "登录成功/密码错误/用户不存在/用户名或密码不能为空/数据库错误/服务器错误",  // 响应信息
    "data": [用户列表],  // 登录成功时返回所有用户数据
    "token": "jwt令牌"  // 登录成功时返回的认证令牌
  }  ```

### 3. 修改密码
- **接口URL**: `/roles/changePassword`
- **请求方式**: PATCH
- **参数传递方式**: Query Parameters + Headers
- **请求参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |-------|------|------|------|
  | newPassword | String | 是 | 新密��� |
  | Authorization | String | 是 | Bearer Token (请求头) |

- **响应结果**:  ```json
  {
    "code": 200/400/500,  // 状态码
    "msg": "密码修改成功/密码修改失败/用户不存在/数据库错误/服务器错误",  // 响应信息
    "data": null,
    "token": null
  }  ```

### 4. 退出登录
- **接口URL**: `/roles/logout`
- **请求方式**: POST
- **参数传递方式**: Headers
- **请求参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |-------|------|------|------|
  | Authorization | String | 是 | Bearer Token (请求头) |

- **响应结果**:  ```json
  {
    "code": 200/500,  // 状态码
    "msg": "退出登录/数据库错误/服务器错误",  // 响应信息
    "data": null,
    "token": null
  }  ```

### 5. 修改角色名称
- **接口URL**: `/roles/changeRoleName`
- **请求方式**: PATCH
- **参数传递方式**: Query Parameters + Headers
- **请求参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |-------|------|------|------|
  | newRoleName | String | 是 | 新角色名称 |
  | Authorization | String | 是 | Bearer Token (请求头) |

- **响应结果**:  ```json
  {
    "code": 200/400/500,  // 状态码
    "msg": "角色名称修改成功/角色名称修改失败/用户不存在/数据库错误/服务器错误",  // 响应信息
    "data": null,
    "token": null
  }  ```

### 6. 注销角色
- **接口URL**: `/roles/deleteRole`
- **请求方式**: DELETE
- **参数传递方式**: Headers
- **请求参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |-------|------|------|------|
  | Authorization | String | 是 | Bearer Token (请求头) |

- **响应结果**:  ```json
  {
    "code": 200/400/500,  // 状态码
    "msg": "删除成功/删除失败/数据库错误/服务器错误",  // 响应信息
    "data": null,
    "token": null
  }  ```

## 用户管理相关接口

### 1. 创建用户
- **接口URL**: `/users/add`
- **请求方式**: POST
- **参数传递方式**: Query Parameters + Headers
- **请求参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |-------|------|------|------|
  | student_Id | String | 是 | 学号 |
  | name | String | 是 | 姓名 |
  | work | String | 是 | 工作 |
  | class_ | String | 是 | 班级 |
  | Authorization | String | 是 | Bearer Token (请求头) |

- **响应结果**:  ```json
  {
    "code": 200/400/500,  // 状态码
    "msg": "创建成功/创建失败/该角色已创建用户，请勿重复创建/服务器错误",  // 响应信息
    "data": {用户信息},  // 创建成功时返回用户信息
    "token": null
  }  ```

### 2. 根据ID查询用户
- **接口URL**: `/users/getUserById/{id}`
- **请求方式**: GET
- **参数传递方式**: Path Variable
- **请求参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |-------|------|------|------|
  | id | Integer | 是 | 用户ID |

- **响应结果**:  ```json
  {
    "code": 200/300/500,  // 状态码
    "msg": "查询成功/用户不存在/服务器错误",  // 响应信息
    "data": {用户信息},  // 查询成功时返回用户信息
    "token": null
  }  ```

### 3. 获取所有用户
- **接口URL**: `/users/getAllUser`
- **请求方式**: GET
- **参数传递方式**: 无
- **响应结果**:  ```json
  {
    "code": 200/500,  // 状态码
    "msg": "查询成功/服务器错误",  // 响应信息
    "data": [用户列表],  // 所有用户信息
    "token": null
  }  ```

### 4. 更新用户信息
- **接口URL**: `/users/update`
- **请求方式**: PUT
- **参数传递方式**: Request Body + Headers
- **请求参数**:  ```json
  {
    "id": "用户ID",
    "student_Id": "学号",
    "name": "姓名",
    "work": "工作",
    "class_": "班级"
  }  ```
  | 参数名 | 类型 | 必填 | 说明 |
  |-------|------|------|------|
  | Authorization | String | 是 | Bearer Token (请求头) |

- **响应结果**:  ```json
  {
    "code": 200/400/500,  // 状态码
    "msg": "更新成功/更新失败/服务器错误",  // 响应信息
    "data": {更新后的用户信息},  // 更新成功时返回
    "token": null
  }  ```

### 5. 删除用户
- **接口URL**: `/users/delete`
- **请求方式**: DELETE
- **参数传递方式**: Headers
- **请求参数**:
  | 参数名 | 类型 | 必填 | 说明 |
  |-------|------|------|------|
  | Authorization | String | 是 | Bearer Token (请求头) |

- **响应结果**:  ```json
  {
    "code": 200/400/500,  // 状态码
    "msg": "删除成功/删除失败/你还未创建用户/服务器错误",  // 响应信息
    "data": null,
    "token": null
  }  ```

## 注意事项
1. 除了注册和登录接口外，所有接口都需要在请求头中携带token
2. token格式为：`Bearer {token字符串}`
3. 服务器返回的状态码说明：
   - 200: 操作成功
   - 300: 查询无结果
   - 400: 客户端错误（参数错误、权限不足等）
   - 500: 服务器错误
4. 每个角色只能创建一个用户信息
5. 修改密码和注销操作会使当前token失效
